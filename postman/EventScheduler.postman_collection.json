{
  "info": {
    "_postman_id": "a3b4c5d6-0000-1111-2222-333344445555",
    "name": "Event Scheduler Demo",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json",
    "description": "Postman collection for demoing Event Scheduler APIs (UTC)."
  },
  "item": [
    {
      "name": "Create Event (ONCE)",
      "request": {
        "method": "POST",
        "header": [
          { "key": "Content-Type", "value": "application/json" }
        ],
        "url": {
          "raw": "{{baseUrl}}/api/events",
          "host": ["{{baseUrl}}"],
          "path": ["api", "events"]
        },
        "body": {
          "mode": "raw",
          "raw": "{\n  \"customerId\": \"{{customerId}}\",\n  \"triggerTime\": \"{{createTriggerTime}}\",\n  \"mode\": \"ONCE\",\n  \"payload\": { \"type\": \"demo\", \"note\": \"hello\" },\n  \"expirationTime\": \"{{createExpirationTime}}\"\n}"
        }
      },
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "pm.test('Created', function () { pm.response.to.have.status(201); });",
              "try {",
              "  var json = pm.response.json();",
              "  pm.collectionVariables.set('eventId', json.eventId);",
              "  pm.collectionVariables.set('lastEventId', json.eventId);",
              "} catch(e) {}"
            ],
            "type": "text/javascript"
          }
        }
      ]
    },
    {
      "name": "Create Event (RECURRING)",
      "request": {
        "method": "POST",
        "header": [
          { "key": "Content-Type", "value": "application/json" }
        ],
        "url": {
          "raw": "{{baseUrl}}/api/events",
          "host": ["{{baseUrl}}"],
          "path": ["api", "events"]
        },
        "body": {
          "mode": "raw",
          "raw": "{\n  \"customerId\": \"{{customerId}}\",\n  \"triggerTime\": \"{{createRecurringTriggerTime}}\",\n  \"mode\": \"RECURRING\",\n  \"recurrence\": { \"infinite\": true, \"delay\": 1, \"timeUnit\": \"MINUTES\" },\n  \"payload\": { \"type\": \"demo\", \"note\": \"recurring\" },\n  \"expirationTime\": \"{{createRecurringExpirationTime}}\"\n}"
        }
      },
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "pm.test('Created', function () { pm.response.to.have.status(201); });",
              "try { var json = pm.response.json(); pm.collectionVariables.set('recurringEventId', json.eventId); } catch(e) {}"
            ],
            "type": "text/javascript"
          }
        }
      ]
    },
    {
      "name": "List Events",
      "request": {
        "method": "GET",
        "url": {
          "raw": "{{baseUrl}}/api/events?page=0&size=10&sort=nextRunTime,asc",
          "host": ["{{baseUrl}}"],
          "path": ["api", "events"],
          "query": [
            {"key":"page","value":"0"},
            {"key":"size","value":"10"},
            {"key":"sort","value":"nextRunTime,asc"}
          ]
        }
      }
    },
    {
      "name": "Get Event by ID",
      "request": {
        "method": "GET",
        "url": {
          "raw": "{{baseUrl}}/api/events/{{eventId}}",
          "host": ["{{baseUrl}}"],
          "path": ["api","events","{{eventId}}"]
        }
      }
    },
    {
      "name": "Reschedule - Change Trigger Time (PATCH)",
      "request": {
        "method": "PATCH",
        "header": [
          { "key": "Content-Type", "value": "application/json" }
        ],
        "url": {
          "raw": "{{baseUrl}}/api/events/{{eventId}}/reschedule",
          "host": ["{{baseUrl}}"],
          "path": ["api","events","{{eventId}}","reschedule"]
        },
        "body": {"mode":"raw","raw":"{\n  \"triggerTime\": \"{{rescheduleTriggerTime}}\"\n}"}
      }
    },
    {
      "name": "Reschedule - Switch to ONCE (PATCH)",
      "request": {
        "method": "PATCH",
        "header": [
          { "key": "Content-Type", "value": "application/json" }
        ],
        "url": {
          "raw": "{{baseUrl}}/api/events/{{recurringEventId}}/reschedule",
          "host": ["{{baseUrl}}"],
          "path": ["api","events","{{recurringEventId}}","reschedule"]
        },
        "body": {"mode":"raw","raw":"{\n  \"mode\": \"ONCE\"\n}"}
      }
    },
    {
      "name": "Reschedule - Update Recurrence Fields (PATCH)",
      "request": {
        "method": "PATCH",
        "header": [
          { "key": "Content-Type", "value": "application/json" }
        ],
        "url": {
          "raw": "{{baseUrl}}/api/events/{{recurringEventId}}/reschedule",
          "host": ["{{baseUrl}}"],
          "path": ["api","events","{{recurringEventId}}","reschedule"]
        },
        "body": {"mode":"raw","raw":"{\n  \"recurrence\": { \n    \"delay\": 5,\n    \"timeUnit\": \"MINUTES\"\n  }\n}"}
      }
    },
    {
      "name": "Cancel Event by ID",
      "request": {
        "method": "POST",
        "url": {
          "raw": "{{baseUrl}}/api/events/{{eventId}}/cancel?cancelledBy={{cancelledBy}}",
          "host": ["{{baseUrl}}"],
          "path": ["api","events","{{eventId}}","cancel"],
          "query": [ {"key":"cancelledBy","value":"{{cancelledBy}}"} ]
        }
      }
    },
    {
      "name": "Cancel Events by Customer",
      "request": {
        "method": "POST",
        "url": {
          "raw": "{{baseUrl}}/api/events/cancel/by-customer/{{customerId}}?cancelledBy={{cancelledBy}}",
          "host": ["{{baseUrl}}"],
          "path": ["api","events","cancel","by-customer","{{customerId}}"],
          "query": [ {"key":"cancelledBy","value":"{{cancelledBy}}"} ]
        }
      }
    },
    {
      "name": "Redis Stats",
      "request": {
        "method": "GET",
        "url": {
          "raw": "{{baseUrl}}/api/events/redis/stats",
          "host": ["{{baseUrl}}"],
          "path": ["api","events","redis","stats"]
        }
      }
    },
    {
      "name": "Health",
      "request": {
        "method": "GET",
        "url": {
          "raw": "{{baseUrl}}/actuator/health",
          "host": ["{{baseUrl}}"],
          "path": ["actuator","health"]
        }
      }
    }
  ],
  "variable": [
    {"key":"baseUrl","value":"http://localhost:8080"},
    {"key":"customerId","value":"11111111-1111-1111-1111-111111111111"},
    {"key":"cancelledBy","value":"22222222-2222-2222-2222-222222222222"},
    {"key":"createTriggerTime","value":"2025-08-14T08:00:00"},
    {"key":"createExpirationTime","value":"2025-08-15T08:00:00"},
    {"key":"createRecurringTriggerTime","value":"2025-08-14T08:02:00"},
    {"key":"createRecurringExpirationTime","value":"2025-08-15T08:02:00"},
    {"key":"rescheduleTriggerTime","value":"2025-08-14T09:00:00"},
    {"key":"eventId","value":""},
    {"key":"recurringEventId","value":""}
  ]
}

